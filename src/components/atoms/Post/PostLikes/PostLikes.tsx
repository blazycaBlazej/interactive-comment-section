import FlipMove from 'react-flip-move'
import { useDispatch, useSelector } from 'react-redux'
import './PostLikes.scss'
import SVG from 'react-inlinesvg'
import { uiActions } from '../../../../store/store'

interface PostLikesProps {
	id: string
	parentId: string | null
}

interface Post {
	id: string
	likesNumber: number
	isLiked: boolean
	replies: {
		id: string
		isLiked: boolean
	}[]
}

interface StateRoot {
	ui: {
		posts: Post[]
	}
}

const PostLikes = ({ id, parentId }: PostLikesProps): JSX.Element => {
	const dispatch = useDispatch()

	let post: any = useSelector((state: StateRoot) => state.ui.posts.find(post => post.id === id))
	const parentPost = useSelector((state: StateRoot) => state.ui.posts.find(post => post.id === parentId))

	if (!post && parentPost) {
		post = parentPost!.replies.find(post => post.id === id)!
	}

	if (!post) {
		return <></>
	}

	const clickHandler = () => {
		dispatch(uiActions.likePost({ id, parentId }))
	}

	return (
		<div className='post-likes' onClick={clickHandler} data-isliked={post.isLiked}>
			<div className='post-likes__svg'>
				<FlipMove duration={300} easing='linear'>
					{post.isLiked && (
						<svg width='16' height='16' viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg'>
							<path
								className='post-likes__svg-fill'
								d='M8 15.1099C7.77222 15.1099 7.55261 15.0273 7.38147 14.8774C6.73511 14.3123 6.11194 13.7811 5.56213 13.3126L5.55933 13.3102C3.94739 11.9365 2.55542 10.7502 1.58691 9.58167C0.504272 8.27527 0 7.03662 0 5.68347C0 4.36877 0.450806 3.15588 1.26929 2.26807C2.09753 1.36975 3.23401 0.875 4.46973 0.875C5.39331 0.875 6.23914 1.16699 6.98364 1.7428C7.35938 2.03345 7.69995 2.38916 8 2.80408C8.30017 2.38916 8.64062 2.03345 9.01648 1.7428C9.76099 1.16699 10.6068 0.875 11.5304 0.875C12.766 0.875 13.9026 1.36975 14.7308 2.26807C15.5493 3.15588 16 4.36877 16 5.68347C16 7.03662 15.4958 8.27527 14.4132 9.58154C13.4447 10.7502 12.0529 11.9364 10.4412 13.3099C9.89038 13.7792 9.26624 14.3112 8.61841 14.8777C8.44739 15.0273 8.22766 15.1099 8 15.1099ZM10 11C9.02917 11 1.6488 7.79639 1 8.5C0.341553 9.21423 0.937134 4.60486 0.937134 5.68347C0.937134 6.82153 1.36011 7.83936 2.30847 8.98364C0 7 5.80286 6.93544 7.38147 8.28078L11.5 11.5C12.0519 11.9703 9.14117 13.5 8 14C8.65503 13.4296 9.28027 13.0677 9.83325 12.5967C9.58972 10 8.35164 11.1061 9.26826 10C10.2165 8.85571 9.14117 10.4809 9.14117 9.34286C9.14117 8.26425 9.79962 2.9823 9.14117 2.26807C8.49249 1.56445 12.5011 1.81226 11.5304 1.81226C10.8192 1.81226 10.1663 2.03833 9.58972 2.48413C9.07593 2.88159 10.0431 12.2451 9.83325 12.5967C9.72534 12.7775 6.38037 5.81166 6.17004 5.81166C5.95972 5.81166 5.60791 5.18079 5.5 5C5.29028 4.64844 5 2.5 5.14232 2.26807C4.56578 1.82227 10.7111 11 10 11Z'
								fill='#3C79F5'
							/>
						</svg>
					)}
					{!post.isLiked && (
						<svg width='16' height='16' viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg'>
							<path
								className='post-likes__svg-border'
								d='M8 15.1099C7.77222 15.1099 7.55261 15.0273 7.38147 14.8774C6.73511 14.3123 6.11194 13.7811 5.56213 13.3126L5.55933 13.3102C3.94739 11.9365 2.55542 10.7502 1.58691 9.58167C0.504272 8.27527 0 7.03662 0 5.68347C0 4.36877 0.450806 3.15588 1.26929 2.26807C2.09753 1.36975 3.23401 0.875 4.46973 0.875C5.39331 0.875 6.23914 1.16699 6.98364 1.7428C7.35938 2.03345 7.69995 2.38916 8 2.80408C8.30017 2.38916 8.64062 2.03345 9.01648 1.7428C9.76099 1.16699 10.6068 0.875 11.5304 0.875C12.766 0.875 13.9026 1.36975 14.7308 2.26807C15.5493 3.15588 16 4.36877 16 5.68347C16 7.03662 15.4958 8.27527 14.4132 9.58154C13.4447 10.7502 12.0529 11.9364 10.4412 13.3099C9.89038 13.7792 9.26624 14.3112 8.61841 14.8777C8.44739 15.0273 8.22766 15.1099 8 15.1099ZM4.46973 1.81226C3.4989 1.81226 2.60706 2.19971 1.95825 2.90332C1.2998 3.61755 0.937134 4.60486 0.937134 5.68347C0.937134 6.82153 1.36011 7.83936 2.30847 8.98364C3.2251 10.0897 4.5885 11.2516 6.16711 12.5969L6.17004 12.5994C6.72192 13.0697 7.34753 13.6029 7.99866 14.1722C8.65369 13.6018 9.28027 13.0677 9.83325 12.5967C11.4117 11.2513 12.775 10.0897 13.6917 8.98364C14.6399 7.83936 15.0629 6.82153 15.0629 5.68347C15.0629 4.60486 14.7002 3.61755 14.0417 2.90332C13.3931 2.19971 12.5011 1.81226 11.5304 1.81226C10.8192 1.81226 10.1663 2.03833 9.58972 2.48413C9.07593 2.88159 8.71802 3.38403 8.50818 3.7356C8.40027 3.91638 8.21033 4.02429 8 4.02429C7.78967 4.02429 7.59973 3.91638 7.49182 3.7356C7.2821 3.38403 6.92419 2.88159 6.41028 2.48413C5.83374 2.03833 5.18079 1.81226 4.46973 1.81226Z'
							/>
						</svg>
					)}
				</FlipMove>
				{/* <svg width='16' height='16' viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg'>
					<path
						className='post-likes__svg-border'
						d='M8 15.1099C7.77222 15.1099 7.55261 15.0273 7.38147 14.8774C6.73511 14.3123 6.11194 13.7811 5.56213 13.3126L5.55933 13.3102C3.94739 11.9365 2.55542 10.7502 1.58691 9.58167C0.504272 8.27527 0 7.03662 0 5.68347C0 4.36877 0.450806 3.15588 1.26929 2.26807C2.09753 1.36975 3.23401 0.875 4.46973 0.875C5.39331 0.875 6.23914 1.16699 6.98364 1.7428C7.35938 2.03345 7.69995 2.38916 8 2.80408C8.30017 2.38916 8.64062 2.03345 9.01648 1.7428C9.76099 1.16699 10.6068 0.875 11.5304 0.875C12.766 0.875 13.9026 1.36975 14.7308 2.26807C15.5493 3.15588 16 4.36877 16 5.68347C16 7.03662 15.4958 8.27527 14.4132 9.58154C13.4447 10.7502 12.0529 11.9364 10.4412 13.3099C9.89038 13.7792 9.26624 14.3112 8.61841 14.8777C8.44739 15.0273 8.22766 15.1099 8 15.1099ZM4.46973 1.81226C3.4989 1.81226 2.60706 2.19971 1.95825 2.90332C1.2998 3.61755 0.937134 4.60486 0.937134 5.68347C0.937134 6.82153 1.36011 7.83936 2.30847 8.98364C3.2251 10.0897 4.5885 11.2516 6.16711 12.5969L6.17004 12.5994C6.72192 13.0697 7.34753 13.6029 7.99866 14.1722C8.65369 13.6018 9.28027 13.0677 9.83325 12.5967C11.4117 11.2513 12.775 10.0897 13.6917 8.98364C14.6399 7.83936 15.0629 6.82153 15.0629 5.68347C15.0629 4.60486 14.7002 3.61755 14.0417 2.90332C13.3931 2.19971 12.5011 1.81226 11.5304 1.81226C10.8192 1.81226 10.1663 2.03833 9.58972 2.48413C9.07593 2.88159 8.71802 3.38403 8.50818 3.7356C8.40027 3.91638 8.21033 4.02429 8 4.02429C7.78967 4.02429 7.59973 3.91638 7.49182 3.7356C7.2821 3.38403 6.92419 2.88159 6.41028 2.48413C5.83374 2.03833 5.18079 1.81226 4.46973 1.81226Z'
					/>

					<path
						className='post-likes__svg-fill'
						d='M8 15.1099C7.77222 15.1099 7.55261 15.0273 7.38147 14.8774C6.73511 14.3123 6.11194 13.7811 5.56213 13.3126L5.55933 13.3102C3.94739 11.9365 2.55542 10.7502 1.58691 9.58167C0.504272 8.27527 0 7.03662 0 5.68347C0 4.36877 0.450806 3.15588 1.26929 2.26807C2.09753 1.36975 3.23401 0.875 4.46973 0.875C5.39331 0.875 6.23914 1.16699 6.98364 1.7428C7.35938 2.03345 7.69995 2.38916 8 2.80408C8.30017 2.38916 8.64062 2.03345 9.01648 1.7428C9.76099 1.16699 10.6068 0.875 11.5304 0.875C12.766 0.875 13.9026 1.36975 14.7308 2.26807C15.5493 3.15588 16 4.36877 16 5.68347C16 7.03662 15.4958 8.27527 14.4132 9.58154C13.4447 10.7502 12.0529 11.9364 10.4412 13.3099C9.89038 13.7792 9.26624 14.3112 8.61841 14.8777C8.44739 15.0273 8.22766 15.1099 8 15.1099ZM10 11C9.02917 11 1.6488 7.79639 1 8.5C0.341553 9.21423 0.937134 4.60486 0.937134 5.68347C0.937134 6.82153 1.36011 7.83936 2.30847 8.98364C0 7 5.80286 6.93544 7.38147 8.28078L11.5 11.5C12.0519 11.9703 9.14117 13.5 8 14C8.65503 13.4296 9.28027 13.0677 9.83325 12.5967C9.58972 10 8.35164 11.1061 9.26826 10C10.2165 8.85571 9.14117 10.4809 9.14117 9.34286C9.14117 8.26425 9.79962 2.9823 9.14117 2.26807C8.49249 1.56445 12.5011 1.81226 11.5304 1.81226C10.8192 1.81226 10.1663 2.03833 9.58972 2.48413C9.07593 2.88159 10.0431 12.2451 9.83325 12.5967C9.72534 12.7775 6.38037 5.81166 6.17004 5.81166C5.95972 5.81166 5.60791 5.18079 5.5 5C5.29028 4.64844 5 2.5 5.14232 2.26807C4.56578 1.82227 10.7111 11 10 11Z'
						fill='#3C79F5'
					/>
				</svg> */}
			</div>
			<div className='post-likes__likes-number'>{post.likesNumber}</div>
		</div>
	)
}

export default PostLikes
